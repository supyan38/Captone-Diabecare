<!DOCTYPE html>
<html>
<head>
  <title>Prediksi Diabetes</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h2>Selamat datang, {{ user }}</h2>
    <a href="/logout">Logout</a>
    <h3>Form Prediksi Risiko Diabetes</h3>
    <form id="predictForm">
        <input type="number" name="age" placeholder="Usia (tahun)" required>
        <input type="number" step="0.1" name="bmi" placeholder="BMI (contoh: 23.5)" required>
        <input type="number" name="glucose_level" placeholder="Kadar Glukosa (mg/dL)" required>

        <select name="physical_activity" required>
            <option value="" disabled selected hidden>Aktivitas Fisik</option>
            <option value="rendah">Rendah</option>
            <option value="sedang">Sedang</option>
            <option value="tinggi">Tinggi</option>
        </select>

        <select name="family_history" required>
            <option value="" disabled selected hidden>Riwayat Keluarga</option>
            <option value="ya">Ada Riwayat</option>
            <option value="tidak">Tidak</option>
        </select>

        <select name="smoker" required>
            <option value="" disabled selected hidden>Status Merokok</option>
            <option value="ya">Perokok</option>
            <option value="tidak">Tidak</option>
        </select>

        <select name="gender" required>
            <option value="" disabled selected hidden>Jenis Kelamin</option>
            <option value="laki-laki">Laki-laki</option>
            <option value="perempuan">Perempuan</option>
        </select>

        <button type="submit">Prediksi</button>
    </form>
    <div id="result"></div>
  </div>
  <script>
    document.getElementById("predictForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const form = e.target;
      const data = {
        age: parseInt(form.age.value),
        bmi: parseFloat(form.bmi.value),
        glucose_level: parseInt(form.glucose_level.value),
        physical_activity: form.physical_activity.value,
        family_history: form.family_history.value,
        smoker: form.smoker.value,
        gender: form.gender.value
      };

      const response = await fetch("/predict", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });

      const result = await response.json();
      document.getElementById("result").innerHTML =
        `<p><strong>Hasil:</strong> ${result.risk_level}<br><strong>Probabilitas:</strong> ${result.probability}</p>`;
    });
  </script>
</body>
</html>
